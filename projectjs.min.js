window.optimizely=window.optimizely||[],window.__optReturnVisitorTracker=function(){var e,t=function(e,t,i,o,n,r){return arguments.length>1?document.cookie=e+"="+encodeURIComponent(t)+(i?"; expires="+new Date(+new Date+1e3*i).toUTCString():"")+(o?"; path="+o:"")+(n?"; domain="+n:"")+(r?"; secure":""):decodeURIComponent((("; "+document.cookie).split("; "+e+"=")[1]||"").split(";")[0])},i="__optReturnVisitorTracking",o=!localStorage.getItem("__optReturnVisitorTrackerDebug")?{log:function(){},group:function(){},groupEnd:function(){},groupCollapsed:function(){},dir:function(){}}:console,n=function(e){return"saw_exp_"+e},r=function(i){var r=a(i)||{},s=r.session,l=s&&s!=e;o.log("+++ sawInPreviousOptimizelySession",l);var p=!(t(n(i))||null||!s);switch(o.log("+++ sawInPreviousBrowserSession",p),p&&t(n(i),"saw",0,"/"),r.mode){case"both":(l||p)&&(window.optimizely.push({type:"event",eventName:r.return_visitor_evt_apiname}),o.log("+++ fire event, return (optimizely OR browser session):",r.return_visitor_evt_apiname));break;case"browser":p&&(window.optimizely.push({type:"event",eventName:r.return_visitor_evt_apiname}),o.log("+++ fire event, return visitor (browser session):",r.return_visitor_evt_apiname));break;case"optimizely":l&&(window.optimizely.push({type:"event",eventName:r.return_visitor_evt_apiname}),o.log("+++ fire event, return visitor (optimizely session):",r.return_visitor_evt_apiname))}},s=function(e){var t=JSON.parse(localStorage.getItem(i))||{};t[e.experimentId]=e,localStorage.setItem(i,JSON.stringify(t))},a=function(e){try{return JSON.parse(localStorage.getItem(i))[e+""]}catch(e){return{}}};window.optimizely.push({type:"addListener",filter:{type:"lifecycle",name:"activated"},handler:function(t){e=optimizely.get("session").sessionId,o.log("+++ INIT v0.1 +++",e,(new Date).getTime()),localStorage.getItem(i)||localStorage.setItem(i,"{}");var n=JSON.parse(localStorage.getItem(i))||{};for(var s in n)r(s);l.initialized=!0}});var l={initialized:!1,getParams:a,getParams:a,setParams:s,decisionMade:function(i){o.log("+++ Decision: Experiment:"+i+", SessionID: "+e);var r=a(i);r.session=e,s(r),o.log("+++ Set Optimizely Session flag",e),t(n(i),"saw",0,"/"),o.log("+++ Set Cookie Session flag",n(i),"=",e)}};return l}();
